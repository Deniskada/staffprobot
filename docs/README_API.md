# üöÄ API –°–µ—Ä–≤–µ—Ä StaffProBot

## –û–±–∑–æ—Ä

StaffProBot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π HTTP API —Å–µ—Ä–≤–µ—Ä**, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ —á–∏—Å—Ç–æ–º Python –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –ø—Ä–æ—Å—Ç–æ—Ç—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **`api_standalone.py`** - API —Å–µ—Ä–≤–µ—Ä —Å –∑–∞–≥–ª—É—à–∫–∞–º–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- **`api_real_db.py`** - API —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **`api_services_standalone.py`** - –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã –±–µ–∑ FastAPI

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã
1. **–†–µ–∂–∏–º –∑–∞–≥–ª—É—à–µ–∫** - –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç mock –¥–∞–Ω–Ω—ã–µ
2. **–†–µ–∂–∏–º –ë–î** - –†–∞–±–æ—Ç–∞–µ—Ç —Å PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏

## üì° API Endpoints

### Health Check
```
GET /health
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "healthy",
  "timestamp": 1755676312.302665,
  "version": "1.0.0",
  "database": "connected" | "disconnected"
}
```

### –ö–æ—Ä–Ω–µ–≤–æ–π endpoint
```
GET /
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "app": "StaffProBot",
  "version": "1.0.0",
  "status": "running",
  "database": "connected" | "disconnected",
  "docs": "disabled"
}
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
```
GET /api/v1/users          # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
GET /api/v1/users/{id}     # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ ID
POST /api/v1/users         # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –û–±—ä–µ–∫—Ç—ã
```
GET /api/v1/objects        # –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤
GET /api/v1/objects/{id}   # –û–±—ä–µ–∫—Ç –ø–æ ID
POST /api/v1/objects       # –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
```

### –°–º–µ–Ω—ã
```
GET /api/v1/shifts         # –°–ø–∏—Å–æ–∫ —Å–º–µ–Ω
GET /api/v1/shifts/{id}    # –°–º–µ–Ω–∞ –ø–æ ID
POST /api/v1/shifts        # –°–æ–∑–¥–∞–Ω–∏–µ —Å–º–µ–Ω—ã
```

## üöÄ –ó–∞–ø—É—Å–∫

### 1. API —Å –∑–∞–≥–ª—É—à–∫–∞–º–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
```bash
python api_standalone.py
# –∏–ª–∏
run_api_standalone.bat
```

### 2. API —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
```bash
python api_real_db.py
# –∏–ª–∏
run_api_real_db.bat
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ—Å—Ç –∑–∞–≥–ª—É—à–µ–∫
python test_api_standalone.py
# –∏–ª–∏
test_api_standalone.bat

# –¢–µ—Å—Ç —Å –ë–î
python test_api_db.py
# –∏–ª–∏
test_api_db.bat
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```python
class DefaultSettings:
    app_name = "StaffProBot"
    version = "1.0.0"
    api_host = "0.0.0.0"
    api_port = 8000
    database_url = "postgresql://postgres:password@localhost:5432/staffprobot"
    debug = True
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `API_HOST` - –•–æ—Å—Ç –¥–ª—è API —Å–µ—Ä–≤–µ—Ä–∞
- `API_PORT` - –ü–æ—Ä—Ç –¥–ª—è API —Å–µ—Ä–≤–µ—Ä–∞
- `DATABASE_URL` - URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –°–£–ë–î
- **PostgreSQL** (–æ—Å–Ω–æ–≤–Ω–∞—è)
- **PostGIS** (–¥–ª—è –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö)

### –ú–∏–≥—Ä–∞—Ü–∏–∏
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
python create_migration.py

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
python apply_migration.py
# –∏–ª–∏
apply_migration.bat
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
- **Unit —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Integration —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints
- **Docker —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- **–¶–µ–ª—å**: 90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- **–¢–µ–∫—É—â–µ–µ**: 70%+ (–æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### CORS
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CORS –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è JSON –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å HTTP –∫–æ–¥–∞–º–∏

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –£—Ä–æ–≤–Ω–∏: INFO, ERROR
- –ö–æ–Ω—Ç–µ–∫—Å—Ç: user_id, request_id, execution_time

### –ú–µ—Ç—Ä–∏–∫–∏
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker
```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL
docker-compose up -d postgres

# –ó–∞–ø—É—Å–∫ API
python api_real_db.py
```

### Production
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `api_real_db.py`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ reverse proxy (nginx)
- SSL/TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å FastAPI

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- ‚ùå –£–±—Ä–∞–ª–∏ FastAPI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π HTTP —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏–ª–∏ –≤—Å–µ API endpoints
- ‚úÖ –£–ª—É—á—à–∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –†–∞–±–æ—Ç–∞–µ—Ç —Å Python 3.11+
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
- **–ì–∏–±–∫–æ—Å—Ç—å** - –õ–µ–≥–∫–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –≤–∏–¥–µ–Ω–∏–µ](vision.md)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](vision.md#23-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö](vision.md#24-–º–æ–¥–µ–ª—å-–¥–∞–Ω–Ω—ã—Ö)
- [–†–∞–±–æ—Ç–∞ —Å LLM](vision.md#25-—Ä–∞–±–æ—Ç–∞-—Å-llm)
