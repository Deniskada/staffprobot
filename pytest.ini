[tool:pytest]
# Конфигурация pytest для StaffProBot

# Пути для поиска тестов
testpaths = tests

# Паттерны файлов с тестами
python_files = test_*.py *_test.py

# Паттерны классов с тестами
python_classes = Test*

# Паттерны функций с тестами
python_functions = test_*

# Маркеры для категоризации тестов
markers =
    unit: Unit tests (быстрые, изолированные)
    integration: Integration tests (медленные, с внешними зависимостями)
    slow: Медленные тесты
    admin: Тесты админской панели
    notifications: Тесты системы уведомлений
    templates: Тесты шаблонов
    api: Тесты API endpoints

# Фильтры предупреждений
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:sqlalchemy.*

# Настройки asyncio
asyncio_mode = auto

# Минимальная версия Python
minversion = 3.8

# Формат вывода
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --color=yes
    --durations=10

# Покрытие кода (если установлен pytest-cov)
# addopts = --cov=apps --cov=core --cov=domain --cov=shared --cov-report=html --cov-report=term-missing

# Игнорирование файлов
norecursedirs = 
    .git
    .tox
    dist
    build
    *.egg
    __pycache__
    .pytest_cache

# Настройки для конкретных тестов
# Unit тесты - быстрые, без внешних зависимостей
unit_tests = 
    tests/unit/

# Integration тесты - медленные, с внешними зависимостями
integration_tests = 
    tests/integration/

# Настройки логирования
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Настройки для отладки
# addopts = -s --pdb --pdbcls=IPython.terminal.debugger:Pdb

# Параллельное выполнение (если установлен pytest-xdist)
# addopts = -n auto

# Настройки для CI/CD
# addopts = --junitxml=test-results.xml --cov-report=xml