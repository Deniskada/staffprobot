<!-- Shared Calendar Navigation Component -->
<div class="calendar-navigation">
    <div class="nav-group">
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="navigateCalendar('prev')">
            <i class="bi bi-chevron-left"></i> Предыдущий
        </button>
        <h4 class="calendar-title mb-0">{{ calendar_title }}</h4>
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="navigateCalendar('next')">
            Следующий <i class="bi bi-chevron-right"></i>
        </button>
    </div>
    
    <div class="nav-actions">
        {% if show_today_button %}
        <button type="button" class="btn btn-primary btn-sm" onclick="goToToday()">
            <i class="bi bi-calendar-today"></i> Сегодня
        </button>
        {% endif %}
        
        {% if show_view_switcher %}
        <div class="btn-group" role="group">
            <button type="button" class="btn btn-outline-secondary btn-sm {% if view_type == 'month' %}active{% endif %}" onclick="switchView('month')">
                <i class="bi bi-calendar3"></i> Месяц
            </button>
            <button type="button" class="btn btn-outline-secondary btn-sm {% if view_type == 'week' %}active{% endif %}" onclick="switchView('week')">
                <i class="bi bi-calendar-week"></i> Неделя
            </button>
        </div>
        {% endif %}
        
        {% if show_filters %}
        <button type="button" class="btn btn-outline-info btn-sm" onclick="toggleFilters()">
            <i class="bi bi-funnel"></i> Фильтры
        </button>
        {% endif %}
        
        {% if show_refresh %}
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="refreshCalendar()">
            <i class="bi bi-arrow-clockwise"></i> Обновить
        </button>
        {% endif %}
    </div>
</div>

<!-- Calendar Navigation JavaScript -->
<script>
// Navigation functions
function navigateCalendar(direction) {
    const currentDate = new Date('{{ current_date }}');
    const newDate = new Date(currentDate);
    
    if (direction === 'prev') {
        if ('{{ view_type }}' === 'month') {
            newDate.setMonth(newDate.getMonth() - 1);
        } else {
            newDate.setDate(newDate.getDate() - 7);
        }
    } else {
        if ('{{ view_type }}' === 'month') {
            newDate.setMonth(newDate.getMonth() + 1);
        } else {
            newDate.setDate(newDate.getDate() + 7);
        }
    }
    
    loadCalendar(newDate);
}

function goToToday() {
    const today = new Date();
    loadCalendar(today);
}

function switchView(viewType) {
    const params = new URLSearchParams(window.location.search);
    params.set('view', viewType);
    window.location.search = params.toString();
}

function toggleFilters() {
    const filtersPanel = document.getElementById('calendar-filters');
    if (filtersPanel) {
        filtersPanel.style.display = filtersPanel.style.display === 'none' ? 'block' : 'none';
    }
}

function refreshCalendar() {
    window.location.reload();
}

function loadCalendar(date) {
    const params = new URLSearchParams(window.location.search);
    params.set('year', date.getFullYear());
    params.set('month', date.getMonth() + 1);
    params.set('day', date.getDate());
    window.location.search = params.toString();
}
</script>
