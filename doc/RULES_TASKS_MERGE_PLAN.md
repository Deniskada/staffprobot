# –ü–ª–∞–Ω —Ä–∞–±–æ—Ç: –ú–µ—Ä–¥–∂ feature/rules-tasks-incidents ‚Üí main

**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 29.10.2025  
**–í–µ—Ç–∫–∞:** `feature/rules-tasks-incidents`  
**–¶–µ–ª—å:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Rules Engine, Tasks v2, Incidents –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ main

---

## üìä –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å

**–°—Ç–∞—Ç—É—Å:** üöß –í —Ä–∞–±–æ—Ç–µ  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** 0/6 —ç—Ç–∞–ø–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ  
**–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ–µ –≤—Ä–µ–º—è:** 8-10 —á–∞—Å–æ–≤

---

## üéØ –≠—Ç–∞–ø—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚úÖ –≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (COMPLETED)
- [x] –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É main –∏ feature/rules-tasks-incidents
- [x] –í—ã—è–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–æ—É—Ç–∏–Ω–≥–æ–º payroll-adjustments
- [x] –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ —Ä–∞–±–æ—Ç
- [x] –§–∏–∫—Å–∞—Ü–∏—è –ø–ª–∞–Ω–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ

**–ö—Ä–∏—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –í `owner_payroll_adjustments.py`: `prefix="/payroll-adjustments"`
- –í `app.py`: `prefix="/owner/payroll/adjustments"`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–∞ ‚Üí `/owner/payroll/adjustments/payroll-adjustments` ‚ùå

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ main (–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ feature):**
- ~20 –∫–æ–º–º–∏—Ç–æ–≤ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏ payroll
- calculation_details –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ monthly –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å payments array
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫
- –û—Ç—á—ë—Ç—ã –ø–æ –≤—ã–ø–ª–∞—Ç–∞–º –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º

---

### ‚è≥ –≠—Ç–∞–ø 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–∏–Ω–≥–∞ payroll-adjustments (30 –º–∏–Ω)

**–ó–∞–¥–∞—á–∏:**
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å prefix –≤ `apps/web/routes/owner_payroll_adjustments.py` ‚Üí –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å prefix –≤ `apps/web/routes/manager_payroll_adjustments.py` ‚Üí –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π:
  - `/owner/payroll/adjustments` ‚úÖ
  - `/manager/payroll/adjustments` ‚úÖ
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ –≤ —à–∞–±–ª–æ–Ω–∞—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å —Ö–∞—Ä–¥–∫–æ–¥)

**Acceptance Criteria:**
- –†–æ—É—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—É—Ç—è–º –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –°—Ç–∞—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–µ –ª–æ–º–∞—é—Ç—Å—è (—Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

---

### ‚è≥ –≠—Ç–∞–ø 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å main (2-3 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
- [ ] –ú–µ—Ä–¥–∂ main ‚Üí feature/rules-tasks-incidents
- [ ] –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:
  - [ ] `apps/web/routes/payroll.py` (–ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤)
  - [ ] `core/celery/tasks/payroll_tasks.py` (celery –∑–∞–¥–∞—á–∏)
  - [ ] `core/celery/tasks/adjustment_tasks.py` (–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏)
  - [ ] `apps/web/templates/owner/payroll_adjustments/list.html`
  - [ ] `apps/web/templates/manager/payroll_adjustments/list.html`
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
  - [ ] Rules Engine —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π calculation_details
  - [ ] Tasks v2 —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Å–º–µ–Ω
  - [ ] Fallback –Ω–∞ legacy-–ø–æ–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

**Acceptance Criteria:**
- –í—Å–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –∏–∑ main —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- Rules Engine –∏ Tasks v2 –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

### ‚è≥ –≠—Ç–∞–ø 3: –î–æ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ (4-5 —á–∞—Å–æ–≤)

#### 3.1. Incidents workflow (2 —á–∞—Å–∞)
- [ ] –†–æ—É—Ç–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ (POST `/owner/incidents/create`)
- [ ] –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è (–≤–µ–±): employee, shift, category, severity, description, media
- [ ] –ë–∞–∑–æ–≤—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª:
  - [ ] New ‚Üí InReview (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
  - [ ] InReview ‚Üí Resolved (—Ä—É—á–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞)
  - [ ] InReview ‚Üí Rejected (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
- [ ] –°–≤—è–∑—å —Å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞–º–∏:
  - [ ] –ü–æ–ª–µ `suggested_adjustments` –≤ –º–æ–¥–µ–ª–∏
  - [ ] –ö–Ω–æ–ø–∫–∞ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫—É" –≤ UI
- [ ] –§–∏–ª—å—Ç—Ä—ã –≤ —Å–ø–∏—Å–∫–µ: status, category, severity, employee, date_range

#### 3.2. Media Orchestrator –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1 —á–∞—Å)
- [ ] –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ `shift_handlers.py` (–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω —Å –∑–∞–¥–∞—á–∞–º–∏)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ `schedule_handlers.py` (–æ—Ç–º–µ–Ω–∞ —Å–º–µ–Ω —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏)
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ flow –≤ –±–æ—Ç–µ

#### 3.3. –¢–µ—Å—Ç—ã (1-2 —á–∞—Å–∞)
- [ ] `tests/integration/test_rules_engine_payroll.py` (Rules + —Ä–∞—Å—á—ë—Ç—ã)
- [ ] `tests/integration/test_tasks_v2_shifts.py` (Tasks —Å shift_id)
- [ ] `tests/unit/test_incident_service.py` (CRUD –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤)
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ: 60%+ –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π

**Acceptance Criteria:**
- Incidents –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å, –º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
- Media Orchestrator –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–æ—Ç–µ
- –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

---

### ‚úÖ –≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (COMPLETED)

#### 4.1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (docker-compose.dev.yml)
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ—É—Ç–æ–≤:
  - [ ] `/owner/rules` (—Å–ø–∏—Å–æ–∫, toggle, SEED)
  - [ ] `/owner/tasks/*` (templates, plan, entries)
  - [ ] `/owner/incidents` (—Å–ø–∏—Å–æ–∫, —Å–æ–∑–¥–∞–Ω–∏–µ, –º–æ–¥–µ—Ä–∞—Ü–∏—è)
  - [ ] `/owner/payroll/adjustments` (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—É—Ç—å)
  - [ ] `/manager/payroll/adjustments` (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—É—Ç—å)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞:
  - [ ] Tasks v2 –≤ "üìã –ú–æ–∏ –∑–∞–¥–∞—á–∏"
  - [ ] Media Orchestrator –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω
  - [ ] –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–º–µ–Ω—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤:
  - [ ] Rules Engine –ø—Ä–∏–º–µ–Ω—è–µ—Ç —à—Ç—Ä–∞—Ñ—ã –∑–∞ –æ–ø–æ–∑–¥–∞–Ω–∏—è
  - [ ] Rules Engine –ø—Ä–∏–º–µ–Ω—è–µ—Ç —à—Ç—Ä–∞—Ñ—ã –∑–∞ –æ—Ç–º–µ–Ω—ã
  - [ ] Fallback –Ω–∞ legacy-–ø–æ–ª—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∞–≤–∏–ª

#### 4.2. –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –∏ –≤—ã–ø–ª–∞—Ç (–æ—Å–Ω–æ–≤–Ω–æ–π flow)
- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫ (shift_base, bonus, penalty)
- [ ] –û—Ç–º–µ–Ω–∞ —Å–º–µ–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ (–∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫, –Ω–µ—É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞)
- [ ] –û–ø–æ–∑–¥–∞–Ω–∏—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏
- [ ] –†–∞—Å—á—ë—Ç —Ç–∞–±–µ–ª–µ–π
- [ ] –û—Ç—á—ë—Ç—ã –ø–æ –≤—ã–ø–ª–∞—Ç–∞–º –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º

**Acceptance Criteria:**
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- –†–µ–≥—Ä–µ—Å—Å–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –¥–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞–ª–∞

---

### ‚è≥ –≠—Ç–∞–ø 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (1 —á–∞—Å)

**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å `doc/vision_v1/features/rules_engine.md`
- [ ] –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å `doc/vision_v1/features/tasks_v2.md`
- [ ] –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å `doc/vision_v1/features/incidents.md`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `doc/DOCUMENTATION_RULES.md` (–Ω–æ–≤—ã–µ —Ä–æ—É—Ç—ã)
- [ ] –°–æ–∑–¥–∞—Ç—å `doc/MIGRATION_GUIDE_RULES_TASKS.md` –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤:
  - –ö–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ —Å legacy –ø–æ–ª–µ–π –Ω–∞ Rules
  - –ö–∞–∫ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å shift_tasks –Ω–∞ Tasks v2
  - Feature-flags –∏ –ø–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `doc/plans/roadmap.md` (–ò—Ç–µ—Ä–∞—Ü–∏—è 36 ‚Üí Completed)

**Acceptance Criteria:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –∏ –ø–æ–ª–Ω–∞
- –ï—Å—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Roadmap –æ—Ç—Ä–∞–∂–∞–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏

---

### ‚è≥ –≠—Ç–∞–ø 6: –î–µ–ø–ª–æ–π (–ø–æ—Å–ª–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

#### 6.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–µ—Ä–¥–∂—É
- [ ] –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ backup –ë–î –ø—Ä–æ–¥–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ dev
- [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### 6.2. –ú–µ—Ä–¥–∂ –≤ main
```bash
git checkout main
git pull origin main
git merge feature/rules-tasks-incidents
git push origin main
```

#### 6.3. –î–µ–ø–ª–æ–π –Ω–∞ prod
```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ –ø—Ä–æ–¥–µ
ssh staffprobot@staffprobot.ru 'cd /opt/staffprobot && git pull origin main'

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
ssh staffprobot@staffprobot.ru 'cd /opt/staffprobot && docker compose -f docker-compose.prod.yml exec web alembic upgrade head'

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏ (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
ssh staffprobot@staffprobot.ru 'cd /opt/staffprobot && docker compose -f docker-compose.prod.yml down && docker compose -f docker-compose.prod.yml up -d'
```

#### 6.4. –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ feature-flags
- [ ] **–î–µ–Ω—å 1:** `enable_rules_engine = True`
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—á—ë—Ç–æ–≤ —à—Ç—Ä–∞—Ñ–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ fallback –Ω–∞ legacy
  - –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
- [ ] **–î–µ–Ω—å 3:** `enable_tasks_v2 = True` (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª)
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞
  - –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] **–î–µ–Ω—å 7:** `enable_incidents = True` (–ø–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫)
  - –û–±—É—á–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - –°–±–æ—Ä feedback

**Acceptance Criteria:**
- –î–µ–ø–ª–æ–π –ø—Ä–æ—à—ë–ª –±–µ–∑ –æ—à–∏–±–æ–∫
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Feature-flags –≤–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω–æ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|-------------|-----------|
| –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –º–µ—Ä–¥–∂–µ main | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ, manual testing |
| –†–µ–≥—Ä–µ—Å—Å–∏—è –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö payroll | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | Feature-flags, fallback, backup –ë–î |
| –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å Rules Engine —Å –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | Fallback –Ω–∞ legacy-–ø–æ–ª—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω |
| –ë–∞–≥–∏ –≤ Tasks v2 –Ω–∞ –ø—Ä–æ–¥–µ | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç |
| –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–Ω–æ–µ | Backup –ë–î, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ dev |

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –º–µ—Ä–¥–∂—É

- [ ] –†–æ—É—Ç–∏–Ω–≥ payroll-adjustments –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ main —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Incidents workflow –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Media Orchestrator –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- [ ] –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (60%+)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
- [ ] –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ
- [ ] Backup –ë–î —Å–æ–∑–¥–∞–Ω
- [ ] –ü–æ–ª—É—á–µ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–ø–æ—Å–ª–µ –º–µ—Ä–¥–∂–∞)
1. **Incidents**: –ë–∞–∑–æ–≤—ã–π workflow, –Ω–µ—Ç –∞–≤—Ç–æ-—Å–æ–∑–¥–∞–Ω–∏—è –∏–∑ –ø—Ä–∞–≤–∏–ª
2. **Rules Engine**: JSON UI, –Ω–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —É—Å–ª–æ–≤–∏–π
3. **Tasks v2**: –ù–µ—Ç drag-drop –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
4. **–¢–µ—Å—Ç—ã**: –ü–æ–∫—Ä—ã—Ç–∏–µ ~60%, –Ω—É–∂–Ω–æ –¥–æ–≤–µ—Å—Ç–∏ –¥–æ 80%+

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–≤–Ω–µ —Å–∫–æ—É–ø–∞)
- –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø—Ä–∞–≤–∏–ª (condition builder)
- –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ incidents –∏–∑ –ø—Ä–∞–≤–∏–ª –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö
- UI –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á —Å drag-drop
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º/–∑–∞–¥–∞—á–∞–º/–∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º
- –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ legacy-–ø–æ–ª–µ–π (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤)

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ:** Den Novikov  
**–°—Ç–∞—Ç—É—Å:** üöß –í —Ä–∞–±–æ—Ç–µ


