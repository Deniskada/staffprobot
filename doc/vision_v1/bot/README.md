# –ë–æ—Ç: –∫–æ–º–∞–Ω–¥—ã –∏ callback-data

## –ö–æ–º–∞–Ω–¥—ã
- /start
- /help
- /status

## Callback data (–ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- `analytics`
- `analytics_cancel`
- `cancel_media_upload:*` - –æ—Ç–º–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ (–ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã)
- `cancel_my_task_media:*` - –æ—Ç–º–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ (–≤–æ –≤—Ä–µ–º—è —Å–º–µ–Ω—ã)
- `cancel_shift_*`
- `close_object` - –∑–∞–∫—Ä—ã—Ç—å –æ–±—ä–µ–∫—Ç (Phase 4B)
- `close_shift`
- `close_shift_*`
- `close_shift_select:*`
- `close_shift_with_tasks:*` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω—ã –ø–æ—Å–ª–µ –æ—Ç–º–µ—Ç–∫–∏ –∑–∞–¥–∞—á
- `complete_my_task:shift_id:task_idx` - –æ—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –≤–æ –≤—Ä–µ–º—è —Å–º–µ–Ω—ã (Phase 4C)
- `complete_shift_task:shift_id:task_idx` - –æ—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã (Phase 4A)
- `confirm_delete_*`
- `confirm_delete_object:*`
- `confirm_delete_timeslot:*`
- `create_*`
- `create_additional_*`
- `create_additional_slot:*`
- `create_regular_*`
- `create_regular_slot:*`
- `create_slot_*`
- `create_slot_custom_*`
- `create_slot_custom_date:*`
- `create_slot_date:*`
- `create_slot_week:*`
- `create_timeslot:*`
- `delete_*`
- `delete_object:*`
- `delete_slot_*`
- `delete_slot_custom_*`
- `delete_slot_custom_date:*`
- `delete_slot_date:*`
- `delete_slot_week:*`
- `delete_timeslot:*`
- `delete_timeslots:*`
- `edit_*`
- `edit_field:*`
- `edit_object:*`
- `edit_slot_*`
- `edit_slot_custom_*`
- `edit_slot_custom_date:*`
- `edit_slot_date:*`
- `edit_slot_week:*`
- `edit_timeslot:*`
- `edit_timeslot_*`
- `edit_timeslot_employees:*`
- `edit_timeslot_notes:*`
- `edit_timeslot_rate:*`
- `edit_timeslot_time:*`
- `edit_timeslots:*`
- `format_*`
- `get_report`
- `get_telegram_id`
- `main_menu`
- `manage_*`
- `manage_timeslots:*`
- `my_tasks` - –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–¥–∞—á–∏ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–º–µ–Ω—ã (Phase 4C, –∑–∞–º–µ–Ω—è–µ—Ç –∫–Ω–æ–ø–∫—É "–ü–æ–º–æ—â—å")
- `open_object` - –æ—Ç–∫—Ä—ã—Ç—å –æ–±—ä–µ–∫—Ç (Phase 4B)
- `open_planned_*`
- `open_planned_shift:*`
- `open_shift`
- `open_shift_*`
- `open_shift_object:*`
- `period_*`
- `report_object_*`
- `retry_*`
- `retry_close_*`
- `retry_close_location:*`
- `retry_location:*`
- `schedule_select_object_*`
- `schedule_select_slot_*`
- `schedule_shift`
- `select_object_to_open:*` - –≤—ã–±–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è (Phase 4B)
- `status`
- `toggle_timeslot_*`
- `toggle_timeslot_status:*`
- `view_*`
- `view_schedule`
- `view_timeslots:*`
- `week_*`

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
- üè¢ –û—Ç–∫—Ä—ã—Ç—å –æ–±—ä–µ–∫—Ç (`open_object`)
- üîí –ó–∞–∫—Ä—ã—Ç—å –æ–±—ä–µ–∫—Ç (`close_object`)
- üîÑ –û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É (`open_shift`)
- üîö –ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É (`close_shift`)
- üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É (`schedule_shift`)
- üìã –ú–æ–∏ –ø–ª–∞–Ω—ã (`view_schedule`)
- üìä –û—Ç—á–µ—Ç (`get_report`)
- üìù –ú–æ–∏ –∑–∞–¥–∞—á–∏ (`my_tasks`) - –∑–∞–º–µ–Ω—è–µ—Ç –∫–Ω–æ–ø–∫—É "–ü–æ–º–æ—â—å" (—Å 12.10.2025)
- üìà –°—Ç–∞—Ç—É—Å (`status`)
- üÜî –ú–æ–π Telegram ID (`get_telegram_id`)

## UserAction (—Ç–∏–ø—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π)
- `OPEN_SHIFT` - –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω—ã
- `CLOSE_SHIFT` - –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω—ã
- `OPEN_OBJECT` - –æ—Ç–∫—Ä—ã—Ç–∏–µ –æ–±—ä–µ–∫—Ç–∞ (Phase 4B)
- `CLOSE_OBJECT` - –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–±—ä–µ–∫—Ç–∞ (Phase 4B)
- `MY_TASKS` - –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤–æ –≤—Ä–µ–º—è —Å–º–µ–Ω—ã (Phase 4C)
- `CREATE_OBJECT` - —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
- `EDIT_OBJECT` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
- `SCHEDULE_SHIFT` - –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–º–µ–Ω—ã
- `VIEW_SCHEDULE` - –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- `CANCEL_SCHEDULE` - –æ—Ç–º–µ–Ω–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–º–µ–Ω—ã
- `CREATE_TIMESLOT` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–π–º-—Å–ª–æ—Ç–∞
- `EDIT_TIMESLOT_*` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–π–º-—Å–ª–æ—Ç–∞
- `REPORT_DATES` - –≤—ã–±–æ—Ä –¥–∞—Ç –¥–ª—è –æ—Ç—á–µ—Ç–∞

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Markdown
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `parse_mode='Markdown'` –≤ Telegram, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º —Ç–µ–∫—Å—Ç–µ (–Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, —Å—Ç–∞—Ç—É—Å—ã) –≤—ã–∑—ã–≤–∞–ª–∏ –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞.

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, —Å—Ç–∞—Ç—É—Å—ã —Å–º–µ–Ω –∏ —Ç.–¥.) —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é `escape_markdown()` –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π.

**–§–∞–π–ª:** `apps/bot/handlers_div/schedule_handlers.py`

**–≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã:** `_`, `*`, `[`, `]`, `(`, `)`, `~`, `` ` ``, `>`, `#`, `+`, `-`, `=`, `|`, `{`, `}`, `.`, `!`

### –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –º–µ–¥–∏–∞ –ø–æ—Å–ª–µ –æ—Ç—á—ë—Ç–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏–∞-–æ—Ç—á—ë—Ç–∞ –ø–æ –∑–∞–¥–∞—á–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–ª –µ—â—ë –æ–¥–Ω–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ, –±–æ—Ç –æ—Ç–≤–µ—á–∞–ª: "‚ÑπÔ∏è –§–æ—Ç–æ/–≤–∏–¥–µ–æ –ø–æ–ª—É—á–µ–Ω–æ, –Ω–æ –Ω–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ—Ç—á—ë—Ç–∞".

**–†–µ—à–µ–Ω–∏–µ:** –í `_handle_received_media` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è `UserStep.TASK_COMPLETION`. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≤–µ—Ä—à–∏–ª –∑–∞–≥—Ä—É–∑–∫—É –∑–∞–¥–∞—á–∏, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –º–µ–¥–∏–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–π.

**–§–∞–π–ª:** `apps/bot/handlers_div/shift_handlers.py`

### –ó–∞—â–∏—Ç–∞ –æ—Ç NULL object_id
**–ü—Ä–æ–±–ª–µ–º–∞:** –í —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —Å–º–µ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –æ–±—ä–µ–∫—Ç—É (`object_id=NULL`), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–µ SQL –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è —Å–º–µ–Ω—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `shift.get('object_id')`. –ï—Å–ª–∏ `object_id` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ: "‚ùå –°–º–µ–Ω–∞ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –æ–±—ä–µ–∫—Ç—É. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."

**–§–∞–π–ª:** `apps/bot/handlers_div/shift_handlers.py`
