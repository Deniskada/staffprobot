# План интеграции фреймворков в StaffProBot

## Обзор инструментов

### 1. cursor-memory-bank
**Назначение**: Система памяти для сохранения контекста между сессиями AI  
**Проблема решает**: AI забывает контекст после каждой сессии  
**Ключевые возможности**:
- Структурированная память проекта (brief, architecture, patterns, progress)
- Модульные режимы: VAN, PLAN, CREATIVE, IMPLEMENT
- Визуальные карты процессов

### 2. OpenSpec
**Назначение**: Spec-driven фреймворк, где спецификации - источник истины  
**Проблема решает**: Непредсказуемые выходы AI, отсутствие требований, избыточные итерации  
**Ключевые возможности**:
- `specs/` - авторитетные спецификации по возможностям
- `changes/` - активные предложения изменений и задачи
- Specification deltas для отслеживания изменений

### 3. spec-kit (GitHub)
**Назначение**: Toolkit для spec-driven разработки с AI  
**Проблема решает**: "Vibe coding" без чётких требований  
**Ключевые возможности**:
- `/specify` - определение требований и user stories
- `/clarify` - разрешение неопределённостей
- `/plan` - технические планы реализации
- `/tasks` - списки задач
- `/analyze` - анализ согласованности
- `/implement` - выполнение задач

### 4. Claude Task Master (TaskMaster)
**Назначение**: Система управления задачами через MCP  
**Проблема решает**: Управление задачами в AI-разработке  
**Ключевые возможности**:
- Интеграция с Cursor через MCP
- Структурированные задачи с контекстом
- Отслеживание прогресса

## Архитектура интеграции

### Связь с существующими инструментами

```
┌─────────────────────────────────────────────────────────┐
│                    StaffProBot                          │
├─────────────────────────────────────────────────────────┤
│                                                           │
│  ┌──────────────┐  ┌──────────────┐                      │
│  │  Supercode   │  │ Memory Bank  │                      │
│  │ (workflows)  │  │ (память)     │                      │
│  └──────┬───────┘  └──────┬───────┘                      │
│         │                  │                              │
│         └──────────────────┼──────────────────┐           │
│                            │                  │           │
│  ┌─────────────────────────┼─────────────────────────┐  │
│  │         Spec-Driven Layer                          │  │
│  │  ┌──────────────┐  ┌──────────────┐              │  │
│  │  │   OpenSpec   │  │   spec-kit   │              │  │
│  │  │  (specs/)    │  │  (команды)  │              │  │
│  │  └──────────────┘  └──────────────┘              │  │
│  └────────────────────────────────────────────────────┘  │
│                            │                             │
│  ┌─────────────────────────┼─────────────────────────┐  │
│  │         Task Management Layer                      │  │
│  │  ┌──────────────┐  ┌──────────────┐              │  │
│  │  │ TaskMaster   │  │  roadmap.md  │              │  │
│  │  │   (MCP)      │  │  (планирование)            │  │
│  │  └──────────────┘  └──────────────┘              │  │
│  └────────────────────────────────────────────────────┘  │
│                                                           │
└─────────────────────────────────────────────────────────┘
```

## План интеграции по этапам

### Этап 1: cursor-memory-bank (Приоритет: Высокий)

**Цель**: Сохранять контекст между сессиями, архитектурные решения, паттерны

**Структура памяти**:
```
.cursor/memory-bank/
├── project-brief.md          # Краткое описание проекта
├── active-focus.md           # Текущий фокус работы
├── architecture.md           # Системная архитектура
├── patterns.md               # Паттерны и практики
├── technical-context.md      # Технический контекст
└── progress.md              # Отслеживание прогресса
```

**Интеграция с существующими правилами**:
- Использовать `.cursor/rules/*.md` как источник для `patterns.md`
- Синхронизировать `active-focus.md` с текущей задачей из `roadmap.md`
- Обновлять `architecture.md` при изменении структуры проекта

**Режимы Memory Bank**:
- **VAN** (Verify, Analyze, Navigate) - для анализа и навигации
- **PLAN** - для планирования (интеграция с roadmap.md)
- **CREATIVE** - для генерации идей
- **IMPLEMENT** - для реализации (интеграция с Supercode workflows)

**Команды**:
- `PLAN` - создать план задачи из roadmap.md
- `ACT` - реализовать задачу через Supercode workflow
- `UPDATE` - обновить память после изменений

### Этап 2: OpenSpec (Приоритет: Средний)

**Цель**: Спецификации как источник истины для требований

**Структура**:
```
specs/
├── capabilities/
│   ├── contract-constructor.md      # Конструктор договоров
│   ├── shift-management.md          # Управление сменами
│   ├── payroll-system.md           # Система расчётов
│   ├── notification-system.md       # Система уведомлений
│   └── ...
└── changes/
    ├── active/
    │   └── contract-constructor-phase2.md
    └── archive/
```

**Интеграция**:
- Спецификации из `specs/` используются как источник истины для AI
- Изменения в `changes/` генерируются перед реализацией
- Specification deltas показывают изменения требований

**Workflow**:
1. Описать изменение → генерируется proposal в `changes/`
2. Review → уточнение спецификации
3. Implement → реализация через Supercode
4. Complete → перенос в `specs/` и архив `changes/`

**Связь с roadmap.md**:
- Каждая задача из roadmap.md может иметь связанную спецификацию
- Изменения спецификаций отслеживаются через deltas

### Этап 3: spec-kit (Приоритет: Средний)

**Цель**: Структурированные команды для spec-driven разработки

**Команды spec-kit**:
- `/specify` - создать/обновить спецификацию в `specs/`
- `/clarify` - разрешить неопределённости в спецификации
- `/plan` - создать технический план (интеграция с roadmap.md)
- `/tasks` - разбить на задачи (интеграция с TaskMaster)
- `/analyze` - проверить согласованность между spec и кодом
- `/implement` - реализовать через Supercode workflow

**Интеграция с OpenSpec**:
- `spec-kit` использует структуру `specs/` от OpenSpec
- Команды `spec-kit` работают с файлами OpenSpec
- `/analyze` проверяет соответствие кода спецификациям

**Интеграция с Supercode**:
- `/implement` запускает соответствующий Supercode workflow
- `/plan` создаёт план, который используется в Supercode режиме "Roadmap Executor"

### Этап 4: Claude Task Master (Приоритет: Низкий)

**Цель**: Управление задачами через MCP для лучшей интеграции с AI

**Установка**:
```bash
npx mcpbar@latest install eyaltoledano/claude-task-master -c claude
```

**Интеграция с roadmap.md**:
- Задачи из roadmap.md синхронизируются с TaskMaster
- TaskMaster отслеживает прогресс выполнения
- Обновления в TaskMaster отражаются в roadmap.md

**Интеграция с Supercode**:
- Workflow "Новая задача из roadmap" может создавать задачи в TaskMaster
- TaskMaster предоставляет контекст для Supercode workflows

**Использование**:
- Для сложных задач с множеством подзадач
- Для отслеживания зависимостей между задачами
- Для автоматизации обновления roadmap.md

## Порядок внедрения

### Фаза 1: Базовая интеграция (1-2 дня)
1. ✅ Установить и настроить cursor-memory-bank
2. ✅ Создать структуру `.cursor/memory-bank/`
3. ✅ Настроить режимы VAN, PLAN, CREATIVE, IMPLEMENT
4. ✅ Интегрировать с `.cursor/rules/` и `roadmap.md`

### Фаза 2: Spec-driven слой (2-3 дня)
1. ✅ Установить OpenSpec структуру (`specs/`, `changes/`)
2. ✅ Мигрировать ключевые спецификации из `doc/vision_v1/` в `specs/`
3. ✅ Установить spec-kit
4. ✅ Настроить команды `/specify`, `/plan`, `/tasks`, `/implement`
5. ✅ Интегрировать с Supercode workflows

### Фаза 3: Task Management (1 день)
1. ✅ Установить Claude Task Master через MCP
2. ✅ Настроить синхронизацию с roadmap.md
3. ✅ Интегрировать с Supercode workflow "Новая задача из roadmap"

### Фаза 4: Оптимизация и документация (1 день)
1. ✅ Создать документацию по использованию всех инструментов
2. ✅ Обновить `.cursor/CHECKLIST.md`
3. ✅ Создать примеры использования
4. ✅ Настроить автоматическую синхронизацию между инструментами

## Workflow интеграции

### Полный цикл разработки задачи

```
1. [Memory Bank: PLAN] 
   → Прочитать roadmap.md, найти задачу
   → Обновить active-focus.md

2. [spec-kit: /specify или /clarify]
   → Создать/обновить спецификацию в specs/
   → Если нужно - создать proposal в changes/

3. [spec-kit: /plan]
   → Создать технический план реализации
   → Разбить на подзадачи

4. [TaskMaster]
   → Создать задачи в TaskMaster
   → Синхронизировать с roadmap.md

5. [Supercode: Roadmap Executor]
   → Запустить workflow "Новая задача из roadmap"
   → Реализовать задачу

6. [spec-kit: /analyze]
   → Проверить соответствие кода спецификации

7. [Memory Bank: UPDATE]
   → Обновить progress.md
   → Обновить architecture.md (если нужно)

8. [OpenSpec]
   → Перенести изменения из changes/ в specs/
   → Архивировать proposal
```

## Преимущества интеграции

### 1. Сохранение контекста
- Memory Bank сохраняет архитектурные решения между сессиями
- OpenSpec сохраняет требования в репозитории
- Нет потери контекста при перезапуске AI

### 2. Чёткие требования
- OpenSpec и spec-kit обеспечивают spec-driven подход
- Требования всегда актуальны и доступны
- Изменения отслеживаются через deltas

### 3. Структурированная работа
- Supercode workflows автоматизируют типовые задачи
- TaskMaster отслеживает прогресс
- roadmap.md остаётся синхронизированным

### 4. Качество кода
- spec-kit `/analyze` проверяет соответствие кода спецификациям
- Supercode режимы проверяют соблюдение правил
- Memory Bank сохраняет лучшие практики

## Риски и митигация

### Риск 1: Дублирование функциональности
**Митигация**: Чёткое разделение ответственности:
- Memory Bank - память между сессиями
- OpenSpec/spec-kit - спецификации как источник истины
- TaskMaster - управление задачами через MCP
- Supercode - workflows и режимы
- roadmap.md - планирование итераций

### Риск 2: Сложность настройки
**Митигация**: Поэтапное внедрение, подробная документация, примеры

### Риск 3: Конфликты синхронизации
**Митигация**: Автоматизация синхронизации через скрипты, чёткие правила приоритетов

## Следующие шаги

1. **Немедленно**: Установить cursor-memory-bank и создать базовую структуру
2. **На этой неделе**: Настроить OpenSpec и spec-kit
3. **На следующей неделе**: Интегрировать TaskMaster и оптимизировать workflows

---

**Дата создания**: 2026-02-04  
**Статус**: План готов к реализации
