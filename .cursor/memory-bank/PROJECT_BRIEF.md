# StaffProBot - Project Brief

## Краткое описание

StaffProBot - система управления персоналом для контроля смен, учёта времени, геолокации, работы с объектами и сотрудниками.

## Ключевые возможности

- **Управление сменами**: Открытие/закрытие смен, контроль геолокации, учёт времени
- **Управление объектами**: Создание объектов, привязка сотрудников, контроль состояния
- **Расчёт зарплат**: Автоматический расчёт по сменам, корректировки, графики выплат
- **Договоры**: Создание и управление договорами, конструктор шаблонов
- **Уведомления**: Система уведомлений для всех ролей
- **Отчёты**: Аналитика и отчёты по работе сотрудников

## Технологический стек

- **Backend**: Python 3.11+, FastAPI, SQLAlchemy 2.0 (async)
- **Database**: PostgreSQL 15+ с PostGIS
- **Cache**: Redis
- **Queue**: Celery + RabbitMQ
- **Bot**: Aiogram 3.x
- **Frontend**: Jinja2 templates, JavaScript (vanilla)
- **Deployment**: Docker Compose

## Архитектура

- **DDD**: Domain-Driven Design с разделением на слои
- **CQRS**: Разделение чтения и записи
- **Микросервисы**: web + bot + celery независимы
- **Async/await**: Для всех I/O операций

## Роли пользователей

1. **Owner** - владелец компании (все права)
2. **Manager** - управляющий объектами (ограниченные права)
3. **Employee** - сотрудник (минимальные права)
4. **Admin** - администратор системы
5. **Moderator** - модератор отзывов

## Ключевые правила разработки

- **user_id** - внутренний ID из БД, НЕ telegram_id
- **Роутинг** - префиксы ролей только в `app.py`
- **Шаблоны** - единый `apps.web.jinja.templates`
- **Сессии БД** - только `Depends(get_db_session)`
- **URLHelper** - без хардкода доменов

## Инструменты разработки

- **Project Brain**: Вопросы по коду (http://192.168.2.107:8003/chat)
- **Supercode.sh**: Workflows и режимы
- **Memory Bank**: Сохранение контекста между сессиями
- **OpenSpec/spec-kit**: Spec-driven разработка
- **TaskMaster**: Управление задачами через MCP

## Документация

- **Vision**: `doc/vision.md` - техническое видение
- **Roadmap**: `doc/plans/roadmap.md` - план разработки
- **Rules**: `.cursor/rules/*.md` - правила разработки
- **Specs**: `specs/` - спецификации (OpenSpec)

---

**Последнее обновление**: 2026-02-04
